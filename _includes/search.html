<div class="search-container">
  <!-- Search Header -->
  <div class="search-header">
    <div class="search-input-wrapper">
      <input type="text" id="search-input" placeholder="Search posts, tags, categories..." autocomplete="off">
      <div class="search-icons">
        <span class="search-icon">üîç</span>
        <button class="clear-search" id="clear-search" title="Clear search">√ó</button>
      </div>
    </div>
    
    <!-- Search Suggestions -->
    <div class="search-suggestions" id="search-suggestions"></div>
  </div>

  <!-- Advanced Filters Toggle -->
  <div class="filters-toggle">
    <button id="toggle-filters" class="filters-btn">
      <span>Advanced Filters</span>
      <span class="toggle-icon">‚ñº</span>
    </button>
    <div class="search-stats" id="search-stats"></div>
  </div>

  <!-- Advanced Filters Panel -->
  <div class="filters-panel" id="filters-panel">
    <div class="filters-grid">
      <!-- Search Type -->
      <div class="filter-group">
        <label>Search In:</label>
        <select id="search-type">
          <option value="all">All Content</option>
          <option value="title">Title Only</option>
          <option value="tags">Tags Only</option>
          <option value="content">Content Only</option>
          <option value="category">Category Only</option>
        </select>
      </div>

      <!-- Sort Options -->
      <div class="filter-group">
        <label>Sort By:</label>
        <select id="sort-by">
          <option value="relevance">Relevance</option>
          <option value="date-desc">Date (Newest)</option>
          <option value="date-asc">Date (Oldest)</option>
          <option value="title">Title A-Z</option>
        </select>
      </div>

      <!-- Date Range -->
      <div class="filter-group">
        <label>Date Range:</label>
        <div class="date-inputs">
          <input type="date" id="date-from" placeholder="From">
          <input type="date" id="date-to" placeholder="To">
        </div>
      </div>
    </div>

    <!-- Category Filters -->
    <div class="category-filters">
      <label>Categories:</label>
      <div class="category-tags" id="category-filters">
        {% assign categories = site.categories | sort %}
        {% for category in categories %}
        <button class="category-tag" data-category="{{ category[0] }}">
          {{ category[0] }} <span class="count">({{ category[1].size }})</span>
        </button>
        {% endfor %}
      </div>
    </div>

    <!-- Tag Cloud -->
    <div class="tag-cloud-section">
      <label>Popular Tags:</label>
      <div class="tag-cloud" id="tag-cloud">
        {% assign tags = site.tags | sort %}
        {% for tag in tags limit: 20 %}
        <button class="tag-item" data-tag="{{ tag[0] }}" style="font-size: {{ tag[1].size | times: 0.1 | plus: 0.8 }}em">
          {{ tag[0] }}
        </button>
        {% endfor %}
      </div>
    </div>

    <!-- Search Options -->
    <div class="search-options">
      <label class="checkbox-wrapper">
        <input type="checkbox" id="fuzzy-search" checked>
        <span>Fuzzy search (typo tolerance)</span>
      </label>
      <label class="checkbox-wrapper">
        <input type="checkbox" id="group-by-category">
        <span>Group results by category</span>
      </label>
      <label class="checkbox-wrapper">
        <input type="checkbox" id="show-excerpts" checked>
        <span>Show content previews</span>
      </label>
    </div>

    <!-- Actions -->
    <div class="filter-actions">
      <button id="reset-filters" class="btn-secondary">Reset All</button>
      <button id="save-search" class="btn-primary">Save Search</button>
    </div>
  </div>

  <!-- Search Results -->
  <div class="search-results-container">
    <div class="results-header" id="results-header"></div>
    <div class="search-results" id="search-results"></div>
    <div class="no-results" id="no-results" style="display: none;">
      <h3>No results found</h3>
      <p>Try adjusting your search terms or filters</p>
    </div>
  </div>

  <!-- Search History -->
  <div class="search-history" id="search-history" style="display: none;">
    <h4>Recent Searches</h4>
    <div class="history-items" id="history-items"></div>
  </div>
</div>

<!-- Search Data -->
<script id="search-data" type="application/json">
{
  "posts": [
    {% for post in site.posts %}
    {
      "title": {{ post.title | jsonify }},
      "url": {{ post.url | jsonify }},
      "date": {{ post.date | date: "%Y-%m-%d" | jsonify }},
      "category": {{ post.categories[0] | default: "Uncategorized" | jsonify }},
      "tags": {{ post.tags | jsonify }},
      "excerpt": {{ post.excerpt | strip_html | truncatewords: 50 | jsonify }},
      "content": {{ post.content | strip_html | jsonify }}
    }{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ]
}
</script>
